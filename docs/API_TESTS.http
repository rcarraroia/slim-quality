### Slim Quality Backend - API Tests
### Sprint 2: Sistema de Produtos
### Use REST Client extension in VS Code

@baseUrl = http://localhost:3000
@token = {{login.response.body.data.session.access_token}}

# ============================================
# AUTENTICAÇÃO
# ============================================

### Login Admin
# @name login
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@slimquality.com",
  "password": "admin123456"
}

### Get Current User
GET {{baseUrl}}/api/auth/me
Authorization: Bearer {{token}}

# ============================================
# PRODUTOS - APIs Públicas
# ============================================

### Listar Produtos
GET {{baseUrl}}/api/products

### Listar Produtos Featured
GET {{baseUrl}}/api/products?featured=true

### Listar Produtos com Paginação
GET {{baseUrl}}/api/products?limit=2&offset=0

### Buscar Produto por Slug
GET {{baseUrl}}/api/products/colchao-magnetico-padrao

### Buscar Produto Solteiro
GET {{baseUrl}}/api/products/colchao-magnetico-solteiro

# ============================================
# TECNOLOGIAS - APIs Públicas
# ============================================

### Listar Tecnologias
GET {{baseUrl}}/api/technologies

### Buscar Tecnologia por Slug
GET {{baseUrl}}/api/technologies/sistema-magnetico

# ============================================
# PRODUTOS - APIs Administrativas
# ============================================

### Listar Todos os Produtos (Admin)
GET {{baseUrl}}/api/admin/products
Authorization: Bearer {{token}}

### Criar Produto (Admin)
POST {{baseUrl}}/api/admin/products
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Colchão Magnético Super King",
  "description": "O maior e mais confortável colchão magnético do mercado",
  "width_cm": 203,
  "length_cm": 203,
  "height_cm": 32,
  "weight_kg": 65,
  "price_cents": 589000,
  "is_featured": false,
  "display_order": 5
}

### Atualizar Produto (Admin)
# Substitua {product_id} pelo ID real
PUT {{baseUrl}}/api/admin/products/{product_id}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "description": "Descrição atualizada do produto",
  "price_cents": 599000
}

### Deletar Produto (Admin)
# Substitua {product_id} pelo ID real
DELETE {{baseUrl}}/api/admin/products/{product_id}
Authorization: Bearer {{token}}

# ============================================
# ESTOQUE - APIs Administrativas
# ============================================

### Consultar Estoque
# Substitua {product_id} pelo ID real
GET {{baseUrl}}/api/admin/products/{product_id}/inventory
Authorization: Bearer {{token}}

### Adicionar Estoque (Entrada)
# Substitua {product_id} pelo ID real
POST {{baseUrl}}/api/admin/products/{product_id}/inventory
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "type": "entrada",
  "quantity": 50,
  "notes": "Recebimento de nova remessa"
}

### Remover Estoque (Saída)
# Substitua {product_id} pelo ID real
POST {{baseUrl}}/api/admin/products/{product_id}/inventory
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "type": "saida",
  "quantity": -5,
  "notes": "Venda manual"
}

### Ajustar Estoque
# Substitua {product_id} pelo ID real
POST {{baseUrl}}/api/admin/products/{product_id}/inventory
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "type": "ajuste",
  "quantity": 10,
  "notes": "Ajuste de inventário"
}

### Ajustar para Quantidade Específica
# Substitua {product_id} pelo ID real
PUT {{baseUrl}}/api/admin/products/{product_id}/inventory/adjust-to
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "target_quantity": 100,
  "notes": "Ajuste para quantidade alvo"
}

### Histórico de Movimentações
# Substitua {product_id} pelo ID real
GET {{baseUrl}}/api/admin/products/{product_id}/inventory/history?limit=20
Authorization: Bearer {{token}}

# ============================================
# IMAGENS - APIs Administrativas
# ============================================

### Upload de Imagem
# Substitua {product_id} pelo ID real
# Use multipart/form-data com campo 'files'
POST {{baseUrl}}/api/admin/products/{product_id}/images
Authorization: Bearer {{token}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="files"; filename="colchao.jpg"
Content-Type: image/jpeg

< ./path/to/image.jpg
------WebKitFormBoundary
Content-Disposition: form-data; name="alt_text"

Colchão Magnético - Vista Frontal
------WebKitFormBoundary
Content-Disposition: form-data; name="is_primary"

true
------WebKitFormBoundary--

### Deletar Imagem
# Substitua {product_id} e {image_id} pelos IDs reais
DELETE {{baseUrl}}/api/admin/products/{product_id}/images/{image_id}
Authorization: Bearer {{token}}

### Definir Imagem Principal
# Substitua {product_id} e {image_id} pelos IDs reais
PUT {{baseUrl}}/api/admin/products/{product_id}/images/{image_id}/primary
Authorization: Bearer {{token}}

### Reordenar Imagens
# Substitua {product_id} pelo ID real
PUT {{baseUrl}}/api/admin/products/{product_id}/images/reorder
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "image_ids": [
    "image-id-1",
    "image-id-2",
    "image-id-3"
  ]
}

# ============================================
# HEALTH CHECK
# ============================================

### Health Check
GET {{baseUrl}}/health

### Root
GET {{baseUrl}}/
